M6R0
I$acg`6Cc#p0$:-1c#p1$:-2c#p2$:-3c#p3$:-4c#p4$:-5c#p5$:-6c#p6$:-7c#p7$:-8c#p8$:-
9c#p9%:-10c$p10%:-11c%acg0%:-12c&acg0a%:-13c&acg0b%:-14c%acg1%:-15c%acg2%:-16c%
acg3%:-17c%acg4%:-18c%acg5%:-19c%acg6%:-20c%acg7%:-21c%acg8%:-22c%acg9%:-23c&ac
g10%:-24c&acg11%:-25c&acg12%:-26c&acg13%:-27c&acg14%:-28c&acg15%:-29c&acg16%:-3
0c&acg17%:-31c'acg17a%:-32c'acg17b%:-33b6#%+thismoduleG6"6#%(packageG6C%#p0G%#p
1G%#p2G%#p3G%#p4G%#p5G%#p6G%#p7G%#p8G%#p9G%$p10G%%acg0G%&acg0aG%&acg0bG%%acg1G%
%acg2G%%acg3G%%acg4G%%acg5G%%acg6G%%acg7G%%acg8G%%acg9G%&acg10G%&acg11G%&acg12G
%&acg13G%&acg14G%&acg15G%&acg16G%&acg17G%'acg17aG%'acg17bGFI6#QBtesting~the~cre
ation~of~a~packageFIFIFIFI6"FI
M6R0
I%:-11R6"F$F$F$>%#pdG-%)jacobianG6$%%funcG%#v1GF$6%F*F&F+F$6#/%+modulenameG%$ac
gG
M6R0
I%:-29R6#%+nreactionsG6)%*precisionG%"iG%"jG%)ratelistG%'args15G%$l15G%(array15
G6"F.C--%,init_genforGF.>8$%'doubleG>8*7#-%$seqG6$&%"rG6$8%8&/F>;"""9$>8'7#-F96
$(%%rateGF>F@>8(7"?(F>FBFBFC%%trueGC$>&FE6#F>-%%subsG6$%(substi1GFR>FL7$-%#opG6
#FL7%%'equalfGF;FR>8)7&7%%)declarefG%(includeG7#%1'common_geo.inc'G7%F]oF^o7#%-
'common.inc'G7%%&callfG%)switchesG7#F?7#FL-%+currentdirG6#%&dir_fG-%(writetoG6#
%(rates.fG-%'genforG6#7&%,subroutinemG%&ratesGFgoFjn-F^p6#%)terminalGF.F.F.6#/%
+modulenameG%$acgG
M6R0
I%:-19R6$%#pdG%&dir_fG6"F'F'C)-%,init_genforGF'>%*precisionG%'doubleG>%#l5G7'7%
%)declarefG%(includeG7#%1'common_geo.inc'G7%F2F37#%-'common.inc'G7%F2%*dimensio
nG7#%0pd(ncomp,ncomp)G7%%&callfG%)switchesG7#%"jG7%%(matrixmG9$FD-%+currentdirG
6#9%-%(writetoG6#%+jacobian.fG-%'genforG6#7&%,subroutinemG%)jacobianG7$FDFAF/-F
J6#%)terminalGF'6$F,F/F'6#/%+modulenameG%$acgG
M6R0
I%:-10R6#%'ncompoG6&%#i1G%&fdnewG%&fdoldG%%deltG6"F+C&>8%-%&evalmG6#-%#&*G6$%(m
atrixMG%*variablesG>8&-F06#-F36$F5%.variables_oldG?(8$"""F@9$%%trueGC$>&%%funcG
6#F?,(FEF@*&&F.FGF@8'!""FL*&&F8FGF@FKFLF@>FE-%%subsG6%%(substi1G%(substi2GFE-%&
printG6#FFF+FWF+6#/%+modulenameG%$acgG
M6R0
I$:-3R6#%*variablesG6%%"iG%%tmp1G%%tmp2G6"F*C&>8%7#-%$seqG6$%#dtG/8$;"""%'ncomp
oG>8&7#-F06$%"dGF3>%%eqnsG7"?(F4F6F6F7%%trueG>F?7$-%#opG6#F?-%$catG6%&F96#F4&9$
FL&F-FLF*FGF*6#/%+modulenameG%$acgG
M6R0
I%:-13R6%%'nopt_vG%(ntopt_vG%+nparam_optG6"F(F(C.-%,init_genforGF(>%&lopt1G6$%$
parG%)timemeasG>%&lopt2G%&idparG@%/9$""!>%*list_opt2G/%'idooptGF7>F9/F;"""@%F5>
%)list_optG/%%noptGF>>FA/FCF6@%/9%F7>FA6$FA/%&ntoptGF>>FA6$FA/FLFH@%/9&F7>FA6$F
A/%*ntotparamGF>>FA6$FA/FV%*nparm_optG>%&l_optG7)7$%+parameterfG7#FA7$Fin7#F97%
%(commonfG%&copt1G7#F-7%F^o%&copt2G7#F27%%)declarefG%*dimensionG7#%Kpar(ntotpar
am),idpar(nopt),timemeas(ntopt)G7%Feo%'real*8GF`o7%Feo%(integerGFco-%+currentdi
rG6#%&dir_fG-%(writetoG6#%/common_opt.incG-%'genforG6#7#Ffn-Fbp6#%)terminalGF(6
'FfnFAF9F-F2F(6#/%+modulenameG%$acgG
M6R0
I%:-17R6&%'nparamG%)bio_nameG%(bio_valG%&dir_fG6$%&args3G%"iG6"F,C+-%,init_genf
orGF,>%*precisionG%'doubleG>8$7"?(8%"""F89$%%trueG>F47$-%#opG6#F47%%'equalfG&9%
6#F7&9&FD>%#l3G7%7%%)declarefG%(includeG7#%1'common_geo.inc'G7%FKFL7#%-'common.
inc'GF4-%+currentdirG6#9'-%(writetoG6#%)biogeo.fG-%'genforG6#7&%,subroutinemG%'
biogeoGF5FH-FW6#%)terminalGF,6$F1FHF,6#/%+modulenameG%$acgG
M6R0
I%:-30R6%%(nsolidsG%+listsolidsG%&dir_fG6&%#ttG%#ppG%#llG%$pp2G6"F-C+-%,init_ge
nforGF->%*precisionG%'doubleG>8'7"?(8&"""F99$%%trueGC$>8$/%"kG&9%6#F8>F57$-%#op
G6#F57%%*if_then_mGF>7#7%%'equalfG%'isolidGF9>%%l16bG7%7%%)declarefG%(includeG7
#%1'common_geo.inc'G7%FSFT7#%-'common.inc'G7#F5-%+currentdirG6#9&-%(writetoG6#%
*issolid.fG-%'genforG6#7&%,subroutinemG%(issolidG7$F@FNFP-Fjn6#%)terminalGF-6%F
2%$l16GFPF-6#/%+modulenameG%$acgG
M6R0
I%:-20G6#/%+modulenameG%$acgG
M6R0
I%:-12R6-%(nsolidsG%+ndissolvedG%'ncompoG%+nreactionsG%)bio_nameG%*phys_nameG%)
phys_valG%+phys_name2G%*phys_val2G%&dir_fG%'nnodesG6$%&tmpopG%$nxvG6"F3C+>8%,&9
.""#!"""""@$2F6F;>F6F;-%,init_genforGF3>%+list_paramG6'/%'nsolidG9$/%&ndissG9%/
%&ncompG9&/%&nreacG9'/%#nxGF6>%"lG7*7%%)declarefG%9implicit~real*8(a-h,o-z)G7"7
$%+parameterfG7#FB7%%(commonfG%)kineticsG9(7%FV%'real*8GFin7%Fgn%(physicsG9)7%F
VF[oF^o7%Fgn%)physics2G9+7%FV%(integerGFbo-%+currentdirG6#9--%(writetoG6#%/comm
on_geo.incG-%'genforG6#7#FS-Fjo6#%)terminalGF36$FSFBF36#/%+modulenameG%$acgG
M6R0
I$:-4R6#%(eqrxnIdG6&%#s1G%#s2G%#s3G%#s4G6"F+C'>8$-%(convertG6$9$%$setG>8%-F06$%
)ratelistGF3>8&-%&minusG6$F5F.>8'-F06$F:%%listG>F87$-%#opG6#F2-FF6#F?F+6#F8F+6#
/%+modulenameG%$acgG
M6R0
I%:-15R6'%(type_upG%+bnddata_upG%*type_downG%-bnddata_downG%&dir_fG6)%'array1G%
'array2G%&args1G%&args2G%'args1bG%'args2bG%#llG6"F2C/-%,init_genforGF2>%*precis
ionG%'doubleG>8$7#-%$seqG6$&%$spbG6$%#iiG"""/FB;FC%'ncompoG>8&7">8(FI>8'FI>8)FI
?(8*FCFCFF%%trueGC&>FH7$-%#opG6#FH7%%'equalfG&F@6$FQFC&9%6#FQ>FK7$-FW6#FK7%FZ&%
$ibcGFfn&9$Fin>FM7$-FW6#FM7%FZ&F@6$FQ""#&9'Fin>FO7$-FW6#FO7%FZ&F`oFio&9&Fin>%#l
1G7*7%%)declarefG%(includeG7#%1'common_geo.inc'G7%FipFjp7#%-'common.inc'G7%FZ%"
jGFCFHFK7%FZFaq%#nxGFMFO-%+currentdirG6#9(-%(writetoG6#%-boundaries.fG-%'genfor
G6#7&%,subroutinemG%+boundariesGFIFfp-Fiq6#%)terminalGF26$F7FfpF26#/%+modulenam
eG%$acgG
M6R0
I%:-16R6&%'ncompoG%)diffdataG%*alphadataG%&dir_fG6'%'array1G%'array2G%&args1G%&
args2G%#iiG6"F/C.-%,init_genforGF/>%*precisionG%'doubleG>8$7#-%$seqG6$&%'dsol_0
G6#%"iG/F?;"""9$>8%7#-F:6$&%$f_TGF>F@>8&7">8'FM?(8(FBFBFC%%trueGC$>FL7$-%#opG6#
FL7%%'equalfG&F=6#FQ&9%Ffn>FO7$-FW6#FO7%FZ&FJFfn&9&Ffn>%#l2G7&7%%)declarefG%(in
cludeG7#%1'common_geo.inc'G7%FeoFfo7#%-'common.inc'GFLFO-%+currentdirG6#9'-%(wr
itetoG6#%,molecular.fG-%'genforG6#7&%,subroutinemG%*molecularGFMFbo-Fap6#%)term
inalGF/6$F4FboF/6#/%+modulenameG%$acgG
M6R0
I%:-31R6$%*variablesG%&dir_fG6)%#ppG%)pp_endifG%"kG%"xG%#ttG%(l_introG%*firstfl
agG6"F/CK>8*""!-%,init_genforGF/>%*precisionG%'doubleG>8$7">8%F;>8&.F?-%'member
G6%%#o2G9$F@F?>8'-%#ifG6%-%%typeG6$F?.%(numericG""#F3@$2F3FGC&>F2""">8(2%%kmo2G
-%#spG6$-%#opG6#F?%"jG>F:7$7$%*if_then_fGFW7'7%%'equalfG%$ho2G$"#5!""7%Fao%%hno
3G$F3F37%Fao%%hmn4GFho7%Fao%%hfe3GFho7%Fao%%hso4GFho>F=7$7#-Fhn6#F=7#%'endiffG>
F?F@-FB6%%$no3GFEF@F?>FGFH@$FRC&>F2FU>FW2%&kmno3GFZ>F:7%7#-Fhn6#F:7#%&elsefG7$F
]o7(7%FaoFboFho7%FaoFgoFco7%Fao%'hno3f2GFcoFioF[pF]p>F=F`p>F?F@-FB6%%%mno2GFEF@
F?>FGFH@$FRC&>F2FU>FW2%&kmno2GFZ>F:7%FcqFfq7$F]o7)FjqF[r7%FaoF]rFho7%FaoFjoFco7
%Fao%'hmn4f2GFcoF[pF]p>F=F`p>F?F@-FB6%%&feoh3GFEF@F?>FGFH@$FRC&>F2FU>FW2%(kmfeo
h3GFZ>F:7%FcqFfq7$F]o7*FjqF[rF^sF_s7%FaoFasFho7%FaoF\pFco7%Fao%'hfe3f2GFcoF]p>F
=F`p>F?F@-FB6%%$so4GFEF@F?>FGFH@$FRC'@$2F3F2C$-%&printG6#F2>F:7$FcqFfq>F2FU>FW2
%&kmso4GFZ>F:7$Fcq7$F]o7+FjqF[rF^sF_sFbtFct7%FaoFetFho7%FaoF^pFco7%Fao%'hso4f2G
Fco>F=F`p>F?F@-FB6%%$ch4GFEF@F?>FGFH@$FRC%>F2FU>F:7%FcqFfq7#7+FjqF[rF^sF_sFbtFc
tF^vF_v7%FaoFavFho>F=7#Fap>8)7%7%%)declarefG%(includeG7#%1'common_geo.inc'G7%Ff
wFgw7#%-'common.inc'G7%Ffw%(integerG7#Fjn>%$l17G7%FcwF:F=-%+currentdirG6#9%-%(w
ritetoG6#%+switches.fG-%'genforG6#7&%,subroutinemG%)switchesGF_x7#Fax-Fhx6#%)te
rminalGF/6$F7FaxF/6#/%+modulenameG%$acgG
M6R0
I$:-5R6#%'ncompoG6#%%idenG6"F(C)>%*precisionG%'doubleG>%"pG-%*genmatrixG6$%%eqn
sG%)ratelistG>%#qqG-%(convertG6$F.%'MatrixG>%$qqqG-F76$F5%)rationalG>8$-%&array
G6%%)identityG;"""9$FE>%"qG-%(augmentG6$F;F@-%&printG6#FIF(6'F+F.FIF5F;F(6#/%+m
odulenameG%$acgG
M6R0
I%:-21R6,%'ncompoG%(noutputG%)nroutputG%+listoutputG%,listroutputG%+file_namesG
%,file_rnamesG%,time_inioutG%-time_intvoutG%&dir_fG6)%#t0G%$t00G%$t0aG%#t1G%$t1
0G%$t1aG%#llG6"F7C5-%,init_genforGF7>%*precisionG%'doubleG>8$7"?(8*"""FC9%%%tru
eGC$>F?7$-%#opG6#F?7&%&openfG"#6-%$catG6$&9)6#FB%%.datG%(replaceG>F?7$FI7$%'clo
sefGFN>8%F@?(FBFCFCFDFEC$>Ffn7$-FJ6#Ffn7&FMFN-FP6$FR%%.inpGFV>Ffn7$F[oFY>8&F@?(
FBFCFC9&FEC$>Fdo7$-FJ6#Fdo7&FMFN-FP6$&9*FTFUFV>Fdo7$FjoFY>8'F@?(FBFCFCFDFEC%>Fd
p7$-FJ6#Fdp7&%,openfappendGFNFO%$oldG>Fdp7$Fip7&%'writemGFN7#%21x,e14.7,2x,f12.
4G7$-%#spG6$&9'FT%"jG%&depthG>Fdp7$FipFY>8(F@?(FBFCFCFDFEC%>F_r7$-FJ6#F_r7&F\qF
NF^oF]q>F_r7$FdrF`q>F_r7$FdrFY>8)F@?(FBFCFCFfoFEC%>F\s7$-FJ6#F\s7&F\qFNF]pF]q>F
\s7$Fas7&FaqFNFbq7$-%"rG6$&9(FTFjqF[r>F\s7$FasFY>%#l7G767%%)declarefG%(includeG
7#%1'common_geo.inc'G7%FctFdt7#%-'common.inc'G7%Fct%'real*8G7#%%timeG7$%*if_the
n_fG-%$ANDG6$/%#ntGFC/FjqFCF?FdoFfn7%%'equalfG%&v_outG9+7%Fgu%&v_intG9,7#%'endi
ffG7$F_u-Fau6$1F]uFhu2Fhu,&F]uFC%%deltGFCFdpF\s7$F_u/Fjq%#nxG7%FguFhu,&FhuFCF[v
FCF]vF]v7$F_u/F]u%%endtGF_rF]v-%+currentdirG6#9--%(writetoG6#%)output.fG-%'genf
orG6#7&%,subroutinemG%$outG7(FjqFduF]uF[rFhuF[vF`t-Fcw6#%)terminalGF76$F<F`tF76
#/%+modulenameG%$acgG
M6R0
I$:-6R6$%'ncompoG%+nreactionsG6'%#j1G%#i1G%#k1G%*pivotrowsG%%flagG6"F-C%>8'7"?(
8$"""F49%%%trueG?(8%F4F49$F6@$0&%"qG6$F8F3""!C%>8(F?@$2F?-%%nopsG6#F0?(8&F4F4FE
F6@$/F8&F06#FIC$>FBF4[@$/FBF?C'>F=-%&pivotG6%F=F8F3-%&printG6#F=>F07$-%#opGFGF8
-FYFGFPFXF-FZF-6#/%+modulenameG%$acgG
M6R0
I%:-32R6$%*nswitchesG%&dir_fG6.%"iG%"jG%"kG%%l17aG%%ll17G%$p17G%%p17aG%)p17star
tG%'p17endG%'p17totG%$k17G%$i17G6"F4C,-%,init_genforGF4>%*precisionG%'doubleG>8
,7"?(8$"""F@9$%%trueGC(>&%+switchcritG6#F?-%%subsG6$%(substi1GFE>8'2""!-%#opG6$
F?FF>8(-FQ6$F?%+switchlistG>8)7%7%%'equalfGFT$"#5!""7#%&elsefG7%FfnFT$FOFO>8*7%
7$%*if_then_fGFMFY7#%'endiffG>F<7$-FQ6#F<F_o>8+7)7%%)declarefG%(includeG7#%1'co
mmon_geo.inc'G7%F]pF^p7#%-'common.inc'G7%F]p%(integerG7#8%7%F]p%'real*8G7#%&x_p
osG7%F]pFip7#%&y_posG7%F]pFip7#%&z_posG7%Ffn.F[q.-%"xG6#Fgp>8-7$FjoF<-%+current
dirG6#9%-%(writetoG6#%+switches.fG-%'genforG6#7&%,subroutinemG%)switchesG7#.Fgp
Fiq-F`r6#%)terminalGF46$F9FFF46#/%+modulenameG%$acgG
M6R0
I%:-22R6)%)nparphysG%*phys_nameG%)phys_valG%*nparphys2G%+phys_name2G%*phys_val2
G%&dir_fG6%%&args8G%'args8bG%"iG6"F0C--%,init_genforGF0>%*precisionG%'doubleG>8
$7"?(8&"""F<9$%%trueG>F87$-%#opG6#F87%%'equalfG&9%6#F;&9&FH>8%F9?(F;F<F<9'F>>FL
7$-FB6#FL7%FE&9(FH&9)FH>%#l8G7&7%%)declarefG%(includeG7#%1'common_geo.inc'G7%Ff
nFgn7#%-'common.inc'GF8FL-%+currentdirG6#9*-%(writetoG6#%(basic.fG-%'genforG6#7
&%,subroutinemG%&basicGF9FY-Fbo6#%)terminalGF06$F5FYF06#/%+modulenameG%$acgG
M6R0
I$:-7R6$%'ncompoG%+nreactionsG6"F'F'C$>%(matrixMG-%*submatrixG6%%"qG;"""9$;,&9%
F0F0F0,&F1F0F4F0>%'rightMG-F,6%F.F/;F0F4F'6%F.F*F7F'6#/%+modulenameG%$acgG
M6R0
I%:-33R6$%,nparametersG%&dir_fG6(%"iG%%l17aG%$p17G%%p17aG%'p17endG%'p17totG6"F.
C,-%,init_genforGF.>%*precisionG%'doubleG>8(7">8&7$7%%)declarefG%(includeG7#%4'
../common_geo.inc'G7%F<%'real*8G7#%.paravalues(*)G?(8$"""FF9$%%trueGC%>8%-%#opG
6$FE%/parameterslistG>8'7%%'equalfGFK&%+paravaluesG6#FE>F67$-FM6#F6FQ>8)7$F9F6-
%+currentdirG6#9%-%(writetoG6#%-parameters.fG-%'genforG6#7&%,subroutinemG%+para
metersG7#.FUFfn-F]o6#%)terminalGF.6#F3F.6#/%+modulenameG%$acgG
M6R0
I%:-23R6%%+nparam_optG%)opt_nameG%&dir_fG6%%'array9G%&args9G%"iG6"F,C+-%,init_g
enforGF,>8$7#-%$seqG6$&%$parG6#8&/F9;"""9$>8%7"?(F9F<F<F=%%trueG>F?7$-%#opG6#F?
7%%'equalfGF6&9%F8>%#l9G7%7%%)declarefG%(includeG7#%1'common_geo.inc'G7%FPFQ7#%
1'common_opt.inc'GF?-%+currentdirG6#9&-%(writetoG6#%-transferfw.fG-%'genforG6#7
&%,subroutinemG%+transferfwGF@FM-Ffn6#%)terminalGF,6#FMF,6#/%+modulenameG%$acgG
M6R0
I$:-8R6#%+nreactionsG6$%"iG%'rates1G6"F)C%?(8$"""F-9$%%trueG>(%"rGF,(%%rateGF,>
8%-%(convertG6$%)ratelistG%'vectorG>%%funcG-%&evalmG6#-%#&*G6$%'rightMGF6F)6#F=
F)6#/%+modulenameG%$acgG
M6R0
I%:-24R6%%+nparam_optG%)opt_nameG%&dir_fG6%%(array10G%'args10G%"iG6"F,C+-%,init
_genforGF,>8$7#-%$seqG6$&%$parG6#8&/F9;"""9$>8%7"?(F9F<F<F=%%trueG>F?7$-%#opG6#
F?7%%'equalfG&9%F8F6>%$l10G7%7%%)declarefG%(includeG7#%1'common_geo.inc'G7%FPFQ
7#%1'common_opt.inc'GF?-%+currentdirG6#9&-%(writetoG6#%/transferback.fG-%'genfo
rG6#7&%,subroutinemG%-transferbackGF@FM-Ffn6#%)terminalGF,6#FMF,6#/%+modulename
G%$acgG
M6R0
I$:-9R6#%(neqrxnsG6&%#j1G%#i1G%#k1G%%flagG6"F+C$@$2""!9$?(8$"""F3F0%%trueG?(8%F
3F3%'ncompoGF4@$0&%'rightMG6$F6F2F/C$?(8&F3F3F7F4>&%(matrixMG6$F6F?$F/F/>&%%fun
cG6#F6&%0equilibriumeqnsG6#F2?(F6F3F3F7F4C%>8'F/?(F2F3F3%+nreactionsGF4@$F9C%>F
OF3-%&printG6#FO[@$/FOF/C'>FFFD?(F2F3F3F7F4>FF,&FFF3*&&FBF<F3,&&%*variablesGFKF
3&%.variables_oldGFK!""F3F3?(F2F3F3F7F4>F[oFD-FV6#FB-FV6#FGF+6$FGFBF+6#/%+modul
enameG%$acgG
M6R0
I%:-25R6&%'nopt_vG%(idpar_vG%(ntopt_vG%.filemeas_nameG6(%(array11G%'args11G%)ar
ray11aG%(args11aG%"iG%0filemeas_name_cG6"F0C.-%,init_genforGF0>8$7#-%$seqG6$&%&
idparG6#8(/F=;"""9$>8%7"?(F=F@F@FA%%trueG>FC7$-%#opG6#FC7%%'equalfGF:&9%F<>8&7#
-F86$&%.file_opt_nameGF</F=;F@9&>8'FD?(F=F@F@FYFFC$>8)&9'F<>Fen7$-FJ6#Fen7%FMFU
((%"'GFinFco>%$l11G7&7%%)declarefG%(includeG7#%1'common_opt.inc'G7%Fho%-charact
er*30G7#%5file_opt_name(ntopt)GFCFen-%+currentdirG6#%&dir_fG-%(writetoG6#%)getd
at.fG-%'genforG6#7&%,subroutinemG%'getdatG7#FVFeo-Fep6#%)terminalGF06#FeoF06#/%
+modulenameG%$acgG
M6R0
I%:-14R6$%+maxxmeas_vG%,maxspmeas_vG6"F'F'C,-%,init_genforGF'>%'lopt1bG6%%)idsp
measG%(nrxmeasG%)nrspmeasG>%'lopt2bG6%%'spmeasG%&xmeasG%(sigmeasG@%/9$""!>%*lis
t_optbG/%)maxxmeasG""">F</F>F9@%/9%F:>F<6$F</%*maxspmeasGF?>F<6$F</FHFD>%'l_opt
bG7(7$%+parameterfG7#F<7%%(commonfG%&meas1G7#F,7%FS%&meas2G7#F27%%)declarefG%*d
imensionG7#%_uidspmeas(ntopt,maxspmeas),nrxmeas(ntopt,maxxmeas),nrspmeas(ntopt)
,spmeas(ntopt,maxspmeas,maxxmeas),xmeas(ntopt,maxspmeas,maxxmeas),sigmeas(ntopt
,maxspmeas,maxxmeas)G7%FZ%(integerGFU7%FZ%'real*8GFX-%+currentdirG6#%&dir_fG-%(
writetoG6#%0common_meas.incG-%'genforG6#7#FM-Fao6#%)terminalGF'6&FMF<F,F2F'6#/%
+modulenameG%$acgG
M6R0
I%:-26R6(%$vicG%(iniconcG%'ncompoG%*listinputG%.file_in_namesG%&dir_fG6(%#t0G%#
t1G%#t2G%#llG%(array12G%'args12G6"F2C3-%,init_genforGF2>%*precisionG%'doubleG>%
$l12G7%7%%)declarefG%(includeG7#%1'common_geo.inc'G7%F=F>7#%-'common.inc'G7%F=F
>7#%3'common_drive.inc'G>%%l12aG7'7$%*if_then_fG/%#icG"""7&%&openfG"#&)%0initia
lconc.txtG%$oldG7(%$domG%"jGFN%#nxG""#7%F=%Bread(85,*)~de,(sp(i,j),i=1,ncomp)G7
"7$%'closefGFQ7#%'endiffG>8(7#-%$seqG6$&%$spiG6#%#iiG/Fco;FN9&>8)Fen?(8'FNFNFfo
%%trueG>Fho7$-%#opG6#Fho7%%'equalfG&Fao6#Fjo&9%Fdp>%%l12bG7%7$FK/FMFX7$Fho7'FU%
"iGFN%&ncompG7(FUFVFNFWFX7%Fbp-%#spG6$F^qFV-Fao6#F^qFhn>8$Fen>8%Fen>8&Fen?(FjoF
NFNFfoF[pC%>Fhq7$-F_p6#Fhq7&FP,&FjoFN"$+"FN-%$catG6$&9(Fdp%%.inpGFS>F\r7$-F_p6#
F\r7$FgnFdr>Fjq7$-F_p6#Fjq7&%&readmGFdr7#%11x,e14.7,2x,f8.4G7$-Fcq6$&9'FdpFV%&d
epthG>%%l12cG7%7$FK/FM""$7%Fhq7(FUFVFNFWFX7#FjqF\rFhn-%+currentdirG6#9)-%(write
toG6#%.initialcond.fG-%'genforG6#7&%,subroutinemG%,initialcondGFen7'F:7%F=%'rea
l*8G7#%+spi(ncomp)GFHFhpF`t-F]u6#%)terminalGF26'F7F:FHFhpF`tF26#/%+modulenameG%
$acgG
M6R0
I%:-27R6#%'ncompoG6+%"iG%(func_ssG%&derivG%%eqnsG%%tmp1G%%tmp2G%)func_numG%)fun
clistG%'args13G6"F0C0-%,init_genforGF0>%*precisionG%'doubleG>8(7#-%$seqG6$%#dtG
/8$;"""9$>8)7#-F;6$%"dGF>>8+7#-F;6$(8%F?F>>8'7">8&FR>8,FR?(F?FAFAFB%%trueGC)>FN
-%$catG6%&FD6#F?&%*variablesGFin&F8Fin>FQ7%%'equalfG%$ratGFN>8*-%%diffG6$FNFjn>
FT7%F_o%%drdcGFbo>FQ-%%subsG6$%(substi1GFQ>FT-F[p6$F]pFT>FV7$-%#opG6#FV7&7$%*if
_then_fG/%$ispGF?FQFT7#%'endiffG>%$l13G7&7%%)declarefG%(includeG7#%1'common_geo
.inc'G7%FaqFbq7#%-'common.inc'G7%%&callfG%)switchesG7#%"jGFV-%+currentdirG6#%&d
ir_fG-%(writetoG6#%*ssrates.fG-%'genforG6#7&%,subroutinemG%(ssratesG7&F`oFhoFjp
F\rF^q-Fbr6#%)terminalGF06$F5F^qF06#/%+modulenameG%$acgG
M6R0
I$:-1R6$%'ncompoG%*variablesG6$%"iG%#vvG6"F*C%>8%7#-%$seqG6$%%_oldG/8$;"""9$>%.
variables_oldG7"?(F4F6F6F7%%trueG>F97$-%#opG6#F9-%$catG6$&9%6#F4&F-FGF*FAF*6#/%
+modulenameG%$acgG
M6R0
I%:-28R6%%+nrnotranspG%-listnotranspG%&dir_fG6%%#ttG%#ppG%#llG6"F,C+-%,init_gen
forGF,>%*precisionG%'doubleG>8%7"?(8&"""F89$%%trueGC$>8$/%"kG&%+listsolidsG6#F7
>F47$-%#opG6#F47%%*if_then_mGF=7%%'equalfG%(itranspGF8>%$l14G7&7%%)declarefG%(i
ncludeG7#%1'common_geo.inc'G7%FQFR7#%-'common.inc'G7%FQ%(integerG7#%*k,itranspG
7#F4-%+currentdirG6#9&-%(writetoG6#%.notransport.fG-%'genforG6#7&%,subroutinemG
%,notransportG7$F?FLFN-F\o6#%)terminalGF,6$F1FNF,6#/%+modulenameG%$acgG
M6R0
I%:-18R6%%'ncompoG%%funcG%&dir_fG6$%&args4G%#llG6"F+C+-%,init_genforGF+>%*preci
sionG%'doubleG>8$7"?(8%"""F79$%%trueG>F37$-%#opG6#F37%%'equalfG&%&funcsG6#F6&9%
FC>%#l4G7'7%%)declarefG%(includeG7#%1'common_geo.inc'G7%FJFK7#%-'common.inc'G7%
FJ%*dimensionG7#%-funcs(ncomp)G7%%&callfG%)switchesG7#%"jGF3-%+currentdirG6#9&-
%(writetoG6#%+residual.fG-%'genforG6#7&%,subroutinemG%)residualG7$FBFYFG-Fin6#%
)terminalGF+6$F0FGF+6#/%+modulenameG%$acgG
M6R0
I$:-2R6&%+nreactionsG%'ncompoG%*variablesG%.variables_oldG6%%"iG%#v2G%&ratesG6"
F-C(>%)ratelistG7#-%$seqG6$(%"rG8$/F7;"""9$>%#v1G7#-F36$&%#spG6$F7%"jG/F7;F:9%>
%(substi1G-%'equateG6$7#9&F=>8%7#-F36$&%&spoldGFCFE>%(substi2G-FK6$7#9'FP>8&-%&
arrayG6#F9F-6&F=F0FIFWF-6#/%+modulenameG%$acgG
